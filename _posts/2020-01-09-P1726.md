---
layout: post
title: P1726 上白泽慧音
date: 2020-01-09 16:11:20
tags: [tarjan]
---

## 题意

求最大强连通分量的裸题,多解输出字典序最小的.

## 题解

tarjan之后比较一下字典序即可.

## 代码

```cpp
#include<cstring>
#include<cstdio>
#include<queue>
#include<vector>
#include<algorithm>
#include<stack>

const int MAXN = 5000+1;

std::vector<int> G[MAXN];
std::vector<int> scc[MAXN];
std::stack<int> S;
int pre[MAXN], lowlink[MAXN], size[MAXN], sccno[MAXN], ismax[MAXN], dfs_clock, scc_cnt;

void dfs(int u)
{
    pre[u] = lowlink[u] = ++ dfs_clock;
    S.push(u);
    for (int i = 0;i < G[u].size();i ++)
    {
        int v = G[u][i];
        if (!pre[v])
        {
            dfs(v);
            lowlink[u] = std::min(lowlink[u], lowlink[v]);
        }
        else if (!sccno[v])
        {
            lowlink[u] = std::min(lowlink[u],pre[v]); 
        }
    }
    if (lowlink[u] == pre[u])
    {
        scc_cnt ++;
        while(1)
        {
            int x = S.top();
            S.pop();
            sccno[x] = scc_cnt;
            scc[scc_cnt].push_back(x);

            if(x == u)
                break;
        }
    }
    return;
}

void addEdge(int u, int v)
{
    G[u].push_back(v);
}

int main()
{
    int n, m;
    scanf("%d %d", &n, &m);
    for (int i = 0;i < m;i ++)
    {
        int t, u, v;
        scanf("%d %d %d", &u, &v, &t);
        addEdge(u, v);
        if (t == 2)
            addEdge(v, u);
    }
    for (int i = 1;i <= n;i ++)
    {
        if(!pre[i]) dfs(i);
    }
    int maxsize = -1;
    int first = 2147483647;
    int ans;
    for (int i = 1;i <= scc_cnt;i ++)
    {
        maxsize = std::max(maxsize, (int)scc[i].size());
    }
    for (int i = 1;i <= scc_cnt;i ++)
    {
        std::sort(scc[i].begin(),scc[i].end());
        if (scc[i].size() == maxsize)
        {
            if (first > scc[i][0])
            {
                first = scc[i][0];
                ans = i;
            }
        }
    }
    printf("%d\n", maxsize);
    for (int i = 0;i < scc[ans].size();i ++)
    {
        printf("%d ",scc[ans][i]);
    }
    return 0;
}
```

